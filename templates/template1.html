<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div class="container">
    <h1 class="text-center my-4">Средние баллы по предметам</h1>
    <div id="graph-img" class="mb-4"></div>
    <div class="row">
        <div class="col">
            <h3>Предметы:</h3>
            <div class="checkbox-container d-flex flex-column">
                {% for subject in subjects_list %}
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="checkbox{{ subject.0 }}"
                               value="{{ subject.1 }}" name="subjects">
                        <label class="form-check-label" for="checkbox{{ subject.0 }}">{{ subject.1 }}</label>
                    </div>
                {% endfor %}
            </div>
        </div>
        <div class="col">
            <h3>Годы:</h3>
            <div class="checkbox-container d-flex flex-column">
                {% for year in years_list %}
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="checkbox-year{{ year }}" value="{{ year }}"
                               name="years">
                        <label class="form-check-label" for="checkbox-year{{ year }}">{{ year }}</label>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>
    <button id="update-graph" class="btn btn-primary btn-block mt-4">Применить</button>
</div>

<script>
    $(document).ready(function () {
        $('#update-graph').click(function () {
            var selectedSubjects = [];
            var selectedYears = [];

            $('input[name="subjects"]:checked').each(function () {
                selectedSubjects.push(parseInt($(this).attr('id').substring(8), 10));
            });

            $('input[name="years"]:checked').each(function () {
                selectedYears.push(parseInt($(this).val(), 10));
            });

            $.ajax({
                url: '/update_graph1/',
                data: {
                    'subjects': selectedSubjects,
                    'years': selectedYears
                },
                dataType: 'html',
                success: function (data) {
                    $('#graph-img').html(data);
                },
                error: function () {
                    alert('Ошибка при построении графика, выберите другие данные');
                }
            });
        });
    });
</script>
</body>


</html>