<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
    <h1>Школы с лучшим средним баллом по предметам</h1>
    <div id="graph-img"></div>

    <div id="checkbox-container">
            {% for subject in subjects_list %}
            <label for="checkbox{{ subject.0 }}">{{ subject.1 }}:</label>
            <input type="checkbox" id="checkbox{{ subject.0 }}" value="{{ subject.1 }}" name="subjects">
        {% endfor %}
    </div>
    <div id="checkbox-container-years">
        {% for year in years_list %}
            <label for="checkbox-year{{ year }}">{{ year }}:</label>
            <input type="checkbox" id="checkbox-year{{ year }}" value="{{ year }}" name="years">
        {% endfor %}
    </div>
    <div id="checkbox-container-schools">
        {% for school in schoolcode_list %}
            <label for="checkbox-school{{ school.1 }}">{{ school.3 }}:</label>
            <input type="checkbox" checked id="checkbox-school{{ school.1 }}" value="{{ school.3 }}" name="schools">
        {% endfor %}
    </div>

    <button id="update-graph">Применить</button>

<script>
$(document).ready(function() {
    $('#update-graph').click(function() {
        var selectedSubjects = [];
        var selectedYears = [];
        var selectedSchools = [];
        console.log(selectedSchools)
        $('input[name="subjects"]:checked').each(function() {
            selectedSubjects.push(parseInt($(this).attr('id').substring(8), 10));
        });

        $('input[name="schools"]:checked').each(function() {
            selectedSchools.push(parseInt($(this).attr('id').substring(15), 10));
        });

        $('input[name="years"]:checked').each(function() {
            selectedYears.push(parseInt($(this).val(), 10));
        });


        $.ajax({
            url: '/update_graph2/',
            data: {
                'subjects': selectedSubjects,
                'years': selectedYears,
                'schools': selectedSchools,
            },
            dataType: 'html',
            success: function(data) {
                $('#graph-img').html(data);
            },
            error: function() {
                alert('Ошибка при построении графика, выберите другие данные');
            }
        });
    });
});
</script>
</body>


</html>